Log File:   /Documents/HERA_Ranking_Logs/HERA_Validation_20251208_181151.txt (Documents (Persistent))
[System] Starting Parallel Pool...
Starting parallel pool (parpool) using the 'Processes' profile ...
Connected to parallel pool with 8 workers.

Running Test Suites...
Running HERA.test.UnitTests
.....
Done HERA.test.UnitTests
__________

Running HERA.test.ScientificSuite

Test 1: Small Sample Size Boundary (Exact Wilcoxon N=10)
--------------------------------------------------------
[Test] Verifying exact p-value calculation for N < 15.
[Setup] Using N=10. Generating Signal (Mean 10) vs Noise (Mean 0).
[Input]
   |    Parameter     | Value |
   ----------------------------
   |Sample Size (N)   |10     |
   |Mean D1 (Signal)  |10.0   |
   |Mean D2 (Noise)   |0.0    |

[Result]
   |       Metric       |  Value   |       Expectation       |
   -----------------------------------------------------------
   |Calculated P-Value  |0.001953  |< 0.005 (Strong Effect)  |

[Status] PASS: Exact test execution successful. Result is a valid probability.
.
Test 2: Statistical Rigor (Holm-Bonferroni Correction)
------------------------------------------------------
[Test] Checking dynamic alpha adaptation for N=5 datasets (10 pairs).
[Setup] Generating random noise data. Alpha Base = 0.05.
[Input]
   |      Parameter      | Value |
   -------------------------------
   |Datasets             |5      |
   |Comparisons (Pairs)  |10     |
   |Base Alpha           |0.05   |

[Result]
   |       Metric       |  Value   |
   ---------------------------------
   |Expected Min Alpha  |0.005000  |
   |Observed Min Alpha  |0.005000  |
   |Difference          |0.0e+00   |
   |Full Vector Match   |true      |

[Status] PASS: Correction correctly applied (Verified against HERA.stats.holm_bonferroni).
.
Test 3: Outlier Robustness & Threshold Logic (Divergence Check)
---------------------------------------------------------------
[Test] Win condition = (p < alpha) AND (|d| > d_thr) AND (r > r_thr).
[Setup] Generating synthetic edge cases to test partial criteria matches.
[Input]
   |    Comparison    |                Scenario                 | Target Failure |
   -------------------------------------------------------------------------------
   |Micro1 vs Micro2  |High Delta (determin.), Trivial RelDiff  |Fail RelDiff    |
   |Noise vs Outlier  |High Mean Diff, Low Median Diff (d)      |Fail Delta      |
   |Thresholds        |Delta > 0.20, RelDiff > 0.05             |-               |

[Result]
   |       Pair       | Delta | RelDiff | Win (Exp: 0) |
   -----------------------------------------------------
   |Micro1 vs Micro2  | 1.00  | 0.0010  |      0       |
   |Noise vs Outlier  | 0.01  |  2.03   |      0       |

[Status] PASS: Partial criteria matches correctly rejected.
.
Test 4: Mathematical Validation (Thresholds/SEM/BCa)
----------------------------------------------------
[Test] Validation of mathematical corner cases (Zero Variance, SEM Logic, BCa Factors).
[Setup]
   | Metric Name |  Data Characteristics  |      Expected Behavior       |
   -----------------------------------------------------------------------
   |ZeroVar      |All zeros (0 variance)  |Thresholds=0, BCa Factors=0   |
   |SmallVar     |Mean~10, SD~0.5         |Valid Thresholds, Finite BCa  |

[Result]
   |          Check          |    Value     |    Reference    | Status |
   ---------------------------------------------------------------------
   |ZeroVar: Delta Thresh    |0.0000e+00    |< 1e-12          |OK      |
   |ZeroVar: RelDiff Boot    |0.0000e+00    |0 (No Var)       |-       |
   |ZeroVar: SEM Thr         |0.0000e+00    |0 (No Var)       |-       |
   |ZeroVar: Final RelDiff   |0.0000e+00    |max(Boot, SEM)   |-       |
   |SmallVar: Delta Thresh   |0.0800        |> 0              |OK      |
   |SmallVar: RelDiff Boot   |0.0072        |Bootstrap        |-       |
   |SmallVar: SEM Thr        |0.0205        |SEM Lower Bound  |-       |
   |SmallVar: Final RelDiff  |0.0205        |max(Boot, SEM)   |true    |
   |BCa Normal (SmallVar)    |0.00 / -0.01  |Finite           |true    |
   |BCa ZeroVar (Safety)     |0.00 / 0.00   |0.00 / 0.00      |true    |

[Status] PASS: All Mathematical Validations successful.
.
Test 5: Stability Check (Identical Data / Zero Variance)
--------------------------------------------------------
[Test] Algorithm stability with absolute zero-variance inputs.
[Input]
   |  Data Type  | Size | Content |
   --------------------------------
   |Zero Matrix  |50x3  |All 0    |

[Result]
   | Outcome  | Fallback Order |
   -----------------------------
   |No Crash  |[1 2 3]         |

[Status] PASS: Stability Check successful.
.
Test 6: Bootstrap Convergence Algorithms (Global Verification)
--------------------------------------------------------------
[Test] Verification of mathematical stopping criteria for bootstrap processes.
[Setup] Testing 3 algorithms (Simple, Robust, Elbow) across 3 analysis types with synthetic Data.
[Input]
   |    Parameter    |  Value   |
   ------------------------------
   |Sample Size (N)  |30        |
   |Means            |[10, 15]  |
   |SD               |3         |

[Result]
   |   Method   |  Mode  |           Configuration            |  Result  | Status |     Logic Check     |
   ------------------------------------------------------------------------------------------------------
   |Thresholds  |Simple  |Tol=1.0%, (No Smooth/Streak)        |B = 400   |  PASS  |Conv. msg found      |
   |Thresholds  |Robust  |Tol=1.0%, Sm=3, St=3                |B = 1150  |  PASS  |Conv + Stable found  |
   |Thresholds  |Elbow   |Tol=-1.0, B_max=5000 (Force Fail)   |B = 100   |  PASS  |Elbow msg found      |
   |BCa         |Simple  |Tol=5.0%, (No Smooth/Streak)        |B = 1700  |  PASS  |Conv. msg found      |
   |BCa         |Robust  |Tol=5.0%, Sm=3, St=3                |B = 3500  |  PASS  |Conv + Stable found  |
   |BCa         |Elbow   |Tol=-1.0, B_max=15000 (Force Fail)  |B = 1300  |  PASS  |Elbow msg found      |
   |Ranking     |Simple  |Tol=0.5%, (No Smooth/Streak)        |B = 100   |  PASS  |Conv. msg found      |
   |Ranking     |Robust  |Tol=0.5%, Sm=3, St=3                |B = 225   |  PASS  |Conv + Stable found  |
   |Ranking     |Elbow   |Tol=-1.0, B_max=1000 (Force Fail)   |B = 50    |  PASS  |Elbow msg found      |

[Status] PASS: All convergence algorithms behave mathematically correct.
.
Test 7: Initial Sorting Logic (Dominance, Delta, Mean)
------------------------------------------------------
[Test] Step 1: Testing Standard Dominance (M1).
[Setup] Datasets: D1=10.0, D2=5.0, D3=0.0 (SD=2.0)

[Result]
   |   Pair   |  P-Value   | Delta  | RelDiff |
   --------------------------------------------
   |D1 vs D2  |9.6344e-10  |0.9256  |0.6667   |
   |D1 vs D3  |7.5569e-10  |1.0000  |2.0000   |
   |D2 vs D3  |2.9938e-09  |0.9176  |2.0000   |

[Status] PASS: M1 Clear Winner (D1>D2>D3): Order is [1 2 3].

[Test] Step 2: Testing Tie-Break via Delta Injection (M1).
[Setup] Generating Noise Data (Means=0). Forcing Ties on Win-Counts.
[Input]
   |   Pair   | Injected Delta | Implication |
   -------------------------------------------
   |D1 vs D2  |      -0.4      |D2 > D1      |
   |D1 vs D3  |      -0.8      |D3 > D1      |
   |D2 vs D3  |      -0.4      |D3 > D2      |

[Result]
   |      Metric       | Final Order |
   -----------------------------------
   |Tie-Break (Delta)  |[3 2 1]      |

[Status] PASS: M1 Tie-Break via Delta: Order is [3 2 1].

[Test] Step 3: Testing Tie-Break via Mean (M1).
[Input]
   | Dataset | Mean |     Condition     |
   --------------------------------------
   |D1       |0.01  |Delta Forced to 0  |
   |D2       |0.02  |Delta Forced to 0  |
   |D3       |0.00  |Delta Forced to 0  |

[Result]
   |      Metric      | Final Order |
   ----------------------------------
   |Tie-Break (Mean)  |[2 1 3]      |

[Status] PASS: M1 Tie-Break via Mean (D2>D1>D3): Order is [2 1 3].
.
Test 8: Mode M1_M2 (Rank Correction Swap)
-----------------------------------------
[Test] Verifying M2 Correction Swap logic.
[Setup] M1 Order: D1 > D2 > D3. M2 Signal: D2 > D1 (Contradiction).
[Input]
   | Metric | Signal Structure |         Implication         |
   -----------------------------------------------------------
   |M1      |D1(10) > D2(5)    |D1 wins (Initial)            |
   |M2      |D2(10) > D1(0)    |D2 wins (Strong Correction)  |

[Result: M2 Stats D1 vs D2]
   | Metric  |   Value    | Threshold | Significant? |
   ---------------------------------------------------
   |Delta    |1.00        |0.15       |     true     |
   |RelDiff  |2.00        |0.05       |     true     |
   |P-Value  |7.5569e-10  |0.05       |     true     |

[Status] PASS: M1_M2 Swap Applied (D2 overtakes D1): Order is [2 1 3].
.
Test 9: Mode M1_M3A (Tie-Break Logic A)
---------------------------------------
[Test] Verifying M3A Tie-Break Logic (using M2 data).
[Setup] M1: Neutral (A>B>C). M2: Strong C > B > A.
[Input]
   | Metric |    Data Structure    |         Role         |
   --------------------------------------------------------
   |M1      |Means ~1.0            |Primary (Neutral)     |
   |M2      |C(20) > B(10) > A(0)  |Tie-Breaker (Strong)  |

[Result]
   |       Check       | Final Order |
   -----------------------------------
   |M3A Logic Applied  |[2 1 3]      |

[Status] PASS: M1_M3A Single Tie-Break (B, A, C): Order is [2 1 3].
   (Validated that M3A strictly limits moves to 1 per dataset).
.
Test 10: Mode M1_M2_M3 (Logic 3B Fallback)
------------------------------------------
[Test] Verifying Logic 3B (M3 Sorting when M1/M2 tied).
[Setup] M1/M2 Neutral (~10). M3 Strong D3(20) > D1/D2(10).
[Input]
   | Dataset | M1 Mean | M2 Mean | M3 Mean |
   -----------------------------------------
   |   D1    |  10.40  |  10.40  |  10.00  |
   |   D2    |  10.20  |  10.20  |  10.00  |
   |   D3    |  10.00  |  10.00  |  20.00  |

[Result]
   |      Check       | Final Order |
   ----------------------------------
   |Logic 3B Applied  |[3 1 2]      |

[Status] PASS: M1_M2_M3 Logic B Swap (D3 moves to top): Order is [3 1 2].
. 
Test 11: Systematic Missing Data (NaN) Handling
-----------------------------------------------
[Test] Algorithm can handle systematic missing data (NaN).
[Setup]
   |      Parameter      |             Description             |
   -------------------------------------------------------------
   |Data Structure       |5 Datasets (D1-D5), N=200 per group  |
   |Missing Data Levels  |20%, 40%, 60%, 80%                   |

[Input]
   |     Parameter     |           Description            |
   --------------------------------------------------------
   |Signal Profile     |Means: [10, 8, 6, 4, 2], SD: 2.0  |
   |Total Data Points  |1000 (Matrix: 200x5)              |
   |Reference Order    |[1 2 3 4 5]                       |

[Result]
   | Missing % | Order Match |         Status         |
   ----------------------------------------------------
   |    20%    |[1 2 3 4 5]  |PASS                    |
   |    40%    |[1 2 3 4 5]  |PASS                    |
   |    60%    |[1 2 3 4 5]  |PASS                    |
   |    80%    |[1 3 2 4 5]  |INFO: Degradation Exp.  |

[Status] PASS: Algorithm works robustly with missing data.
.
Test 12: Cycle Detection (Artificial Injection)
-----------------------------------------------
[Test] Cycle Detection and Fallback Logic.
[Setup] M1: Transitive. M2: Artificial Cycle injected via Cliff's Delta.
[Input: M2 Injection]
   |  Pair  | Delta | Direction |
   ------------------------------
   |2 vs 1  | -0.9  |2 > 1      |
   |3 vs 2  | -0.9  |3 > 2      |
   |1 vs 3  | +0.9  |1 > 3      |

[Result]
   |      Check      | Outcome |
   -----------------------------
   |Cycle Detected?  |  true   |
   |Final Order      | [1 2 3] |

[Status] PASS: Cycle Handled (Revert to M1): Order is [1 2 3].
[Status] PASS: Infinite loop detected, M2 swaps aborted.
.
Test 13: Pathological Data (Efron's Dice)
-----------------------------------------
[Test] Handling of Nontransitive Dice Data (Real-world Cycle).
[Setup] M1: Transitive [40, 30, 20, 10]. M2: Efron's Dice.
[Input]
   | Metric |               Data Structure               |
   -------------------------------------------------------
   |M1      |40 > 30 > 20 > 10                           |
   |M2      |A>B (2/3), B>C (2/3), C>D (2/3), D>A (2/3)  |

[Result] Final Order: [1 2 3 4]
[Status] PASS: Algorithm terminated with valid rank (Stable Fallback).
.
Test 14: Dynamic Cycle Handling (Efron's Dice + Auto-Thresholds)
----------------------------------------------------------------
[Test] Full pipeline execution with dynamic thresholds on cycle data.
[Setup] 1. Calculate Thresholds -> 2. Run Ranking (M1_M2). This test uses the same Efron Data as in Test 13.
[Input: Calculated Thresholds]
   |   Metric   | Delta Thr | RelDiff Thr |
   ----------------------------------------
   |Base (M1)   |1.000      |0.386        |
   |Efron (M2)  |0.075      |0.190        |

[Result]
   |     Check     |  Outcome  |
   -----------------------------
   |Cycle Active?  |false      |
   |Final Order    |[1 2 3 4]  |

[Status] PASS: Pipeline finished with valid order.
.
Test 15: Global System Test (Static Thresholds)
-----------------------------------------------
[Test] Multi-Tier "Waterfall" sorting (M2 Correction, M1 Base, M3 Tail).
[Input: Data Profile (Waterfall Structure)]
   |     Tier     | Rep. | M1 (Mean) | M2 (Mean) | M3 (Mean) |    Intended Logic     |
   -----------------------------------------------------------------------------------
   |Top (Tier 2)  |  D6  |   100.0   |   120.0   |   100.0   |M2 High -> Correction  |
   |Mid (Tier 1)  |  D1  |   120.0   |   100.0   |   100.0   |M1 High -> Base Rank   |
   |Low (Tier 3)  | D11  |   80.0    |   100.0   |   95.0    |M3A Swap Logic         |
   |Bot (Tier 4)  | D13  |   60.0    |   100.0   |   90.0    |M3B Sorting Logic      |

[Result]
   |    Group    | Mean Rank | Expectation | Status |
   --------------------------------------------------
   |Tier 2 (M2)  |    3.0    |Top (~3.0)   |  true  |
   |Tier 1 (M1)  |    8.0    |Mid (~8.0)   |  true  |
   |Tier 3 (M3)  |   13.0    |Bot (~13.0)  |   -    |

[Status] PASS: Full Hierarchy respected (M2 > M1 > M3).
.
Test 16: Full System Integration (15 Datasets + Auto-Thresholds)
----------------------------------------------------------------
[Test] Validating the full logic chain (M2 correction, M3A tie-break, M3B sort).
[Setup] Re-generating "Waterfall" data (same profile as Test 15) to test Dynamic Thresholds.
[Input: Tiers & Logic Targets]
   |  Tier  | Datasets |              Target Logic              |
   --------------------------------------------------------------
   |Tier 1  |D1-D5     |Base Rank (Mid) -> Displaced by Tier 2  |
   |Tier 2  |D6-D10    |Correction (Top) -> Wins via M2         |
   |Tier 3  |D11-D12   |Tie-Break -> Logic 3A (M3 Swap)         |
   |Tier 4  |D13-D15   |Sorting -> Logic 3B (M3 Gradient)       |

[Result]
   | Rank | Dataset | M1 Mean | M2 Mean | M3 Mean |
   ------------------------------------------------
   |  1   |   D6    |  100.0  |  120.0  |  100.0  |
   |  2   |   D7    |  100.0  |  120.0  |  100.0  |
   |  3   |   D8    |  100.0  |  120.0  |  100.0  |
   |  4   |   D9    |  100.0  |  120.0  |  100.0  |
   |  5   |   D10   |  100.0  |  120.0  |  100.0  |
   |  6   |   D3    |  120.0  |  100.0  |  100.0  |
   |  7   |   D2    |  120.0  |  100.0  |  100.0  |
   |  8   |   D4    |  120.0  |  100.0  |  100.0  |
   |  9   |   D1    |  120.0  |  100.0  |  100.0  |
   |  10  |   D5    |  120.0  |  100.0  |  100.0  |
   |  11  |   D12   |  80.0   |  100.0  |  105.0  |
   |  12  |   D11   |  80.0   |  100.0  |  95.0   |
   |  13  |   D15   |  60.0   |  100.0  |  110.0  |
   |  14  |   D14   |  60.0   |  100.0  |  100.0  |
   |  15  |   D13   |  60.0   |  100.0  |  90.0   |

[Status] PASS: Full System Validation Successful.
.
Test 17: Bootstrap Rank Stability Analysis
------------------------------------------
[Test] Verification of rank stability and confidence interval separation.
[Setup] Re-generating "Waterfall" data (same profile as Test 15) for Stability Analysis.
[Input]
   |    Parameter     |          Value          |
   ----------------------------------------------
   |Data Profile      |Waterfall (see Test 15)  |
   |Bootstrap Method  |Cluster Bootstrap        |
   |Iterations (B)    |100                      |

[Result: Rank Distributions]
   | Rank | Dataset |          Distribution (B=100)          |
   -----------------------------------------------------------
   |  1   |   D6    |1: 100%                                 |
   |  2   |   D7    |2: 100%                                 |
   |  3   |   D8    |3: 100%                                 |
   |  4   |   D9    |4: 87%, 5: 13%                          |
   |  5   |   D10   |4: 13%, 5: 87%                          |
   |  6   |   D3    |6: 36%, 7: 41%, 8: 18%, 9: 4%, 10: 1%   |
   |  7   |   D2    |6: 45%, 7: 26%, 8: 15%, 9: 8%, 10: 6%   |
   |  8   |   D4    |6: 8%, 7: 16%, 8: 40%, 9: 26%, 10: 10%  |
   |  9   |   D1    |6: 10%, 7: 13%, 8: 9%, 9: 26%, 10: 42%  |
   |  10  |   D5    |6: 1%, 7: 4%, 8: 18%, 9: 36%, 10: 41%   |
   |  11  |   D12   |11: 100%                                |
   |  12  |   D11   |12: 100%                                |
   |  13  |   D15   |13: 100%                                |
   |  14  |   D14   |14: 100%                                |
   |  15  |   D13   |15: 100%                                |

[Status] PASS: Separation confirmed: Robust distinction between Tiers.
[Status] PASS: Overlap confirmed: Correctly identifies D1 and D2 have overlapping CIs.
.
Test 18: Borda Count Aggregation Logic Check
--------------------------------------------
[Test] Correctness of Borda score calculation.
[Setup] Simulating specific rank distribution for 3 datasets over 2 permutations.
[Input]
   | Dataset | Ranks (P1, P2) | Points Calc |
   ------------------------------------------
   |   D1    |      1, 2      |2 + 1 = 3    |
   |   D2    |      2, 1      |1 + 2 = 3    |
   |   D3    |      3, 3      |0 + 0 = 0    |

[Result]
   | Dataset | Score | Expected |
   ------------------------------
   |   D1    | 75.0% |  75.0%   |
   |   D3    | 0.0%  |   0.0%   |

[Status] PASS: Borda calculation mathematically correct.
.
Test 19: Post-Hoc Power Analysis (Sanity Check)
-----------------------------------------------
[Test] Verifying that Power Analysis returns plausible values (0 <= Power <= 1).
[Setup]
   |  Dataset   | Mean | SD  |      Description      |
   ---------------------------------------------------
   |HighSignal  | 10.0 | 2.0 |Strong Effect Source   |
   |LowSignal   | 0.0  | 2.0 |Noise/Reference Group  |

[Input]
   |  Parameter   |       Value        |        Condition         |
   ----------------------------------------------------------------
   |Subjects (N)  |20                  |Resampling Size           |
   |Simulations   |100                 |Bootstrap Iterations      |
   |Alpha Limit   |0.050               |Significant if p < Alpha  |
   |Effect Limit  |d > 0.15, r > 0.05  |Relevant if Eff > Limit   |

[Result]
   |      Metric      | Value |   Plausibility    |
   ------------------------------------------------
   |Calculated Power  |1.00   |> 0.80 (Expected)  |

[Status] PASS: Power Analysis produced a logical high value for strong signal.
.
Done HERA.test.ScientificSuite
__________

Running HERA.test.SystemTests

[SystemTest] Developer Mode (Direct API)...
